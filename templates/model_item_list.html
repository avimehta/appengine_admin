{% extends 'admin_base.html' %}
{% from 'macros.html' import pagination with context %}

{% set breadcrumbs = [(uri_for('list', model_name=model_name), model_name)] %}

{% block title %}
  <div class='btn-group pull-right'>
    <a href='{{ uri_for('new', model_name=model_name) }}'><div class='btn btn-info'>New {{ model_name }}</div></a>
  </div>
  <h1>Browse {{ model_name }}s</h1>
{% endblock %}

{% block content %}
  {{ pagination(page) }}
  <table class='table table-striped table-bordered table-hover'>
    <thead>
    <tr>
{% for property in list_properties %}
      <th>{{ property.verbose_name }}</th>
{% endfor %}
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
{% for item in items %}
    <tr>
  {% for property in item._list_properties_copy %}
    {% if loop.first %}
      <td><a href='{{ uri_for('edit', model_name=model_name, key=item.key()) }}'>
      {% if property.typeName == 'BlobProperty' %}
        Binary content
      {% else %}
        {{ property.value|escape }}
      {% endif %}
      </a></td>
    {% else %}
      <td>
        {% if property.typeName == 'BlobProperty' %}
          {% if property.value %}
        <a href='{{ uri_for('blob', model_name=model_name, field_name=property.name, key=item.key()) }}'>File uploaded: {{property.meta.File_Name}}</a>
          {% else %}
        None
        {% endif %}
      {% else %}
        {{ property.value|escape }}
      {% endif %}
      </td>
    {% endif %}
  {% endfor %}
      <td>
        <form class='mini-form form-delete' action='{{ uri_for('delete', model_name=model_name, key=item.key()) }}' method='POST'>
          <button type='submit' name='delete' class='btn btn-mini btn-warning'>Delete</button>
        </form>
      </td>
    </tr>
{% endfor %}
    </tbody>
  </table>
  {{ pagination(page) }}
{% endblock %}

{% block javascript %}
  <script type='text/javascript'>
    $('.form-delete').submit(function(e) {
      return confirm('Are you sure you want to delete this item?');
    });
  </script>
{% endblock %}
